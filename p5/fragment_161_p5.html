<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>wave</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <style>
      body {
        margin: 0;
        overflow: hidden;
        background-color: #000;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }
      canvas {
        display: block;
      }
      .caption {
        position: absolute;
        left: 16px;
        bottom: 16px;
        color: #fff;
        font-family: Helvetica, Arial;
        z-index: 10;
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <div class="caption">“wave”</div>
    <script>
      let l, n;
      let t;

      function setup() {
        createCanvas(800, 800, WEBGL);
        l = 8;
        n = 60;
      }

      function draw() {
        t = millis() / 800;
        background(10, 15, 30);

        let camX = cos(t * 0.3) * 600;
        let camZ = sin(t * 0.3) * 600;
        camera(camX, -500, camZ, 0, 0, 0, 0, 1, 0);

        ambientLight(60);
        pointLight(0, 255, 255, 200, -500, 300);
        pointLight(255, 0, 150, -200, -500, -300);

        let mx = map(mouseX, 0, width, -(l * n) / 2, (l * n) / 2);
        let my = map(mouseY, 0, height, -(l * n) / 2, (l * n) / 2);

        push();
        rotateX(PI / 2);

        for (let i = 0; i < n - 1; i++) {
          beginShape(TRIANGLE_STRIP);
          for (let j = 0; j < n; j++) {
            createVertex(i, j, mx, my);
            createVertex(i + 1, j, mx, my);
          }
          endShape();
        }
        pop();
      }

      function createVertex(i, j, mx, my) {
        let x = l * i - (l * n) / 2;
        let y = l * j - (l * n) / 2;

        let d1 = dist(0, 0, x, y);
        let z1 = exp(-d1 / 150) * sin(d1 / 15 - t) * 60;

        let d2 = dist(mx, my, x, y);
        let z2 = exp(-d2 / 100) * sin(d2 / 12 - t * 2) * 40;

        let z = z1 + z2;

        let colorVal = map(z, -40, 40, 0, 255);

        specularMaterial(colorVal, 255 - colorVal, 255);
        shininess(20);

        stroke(colorVal, 100, 255, 150);
        strokeWeight(0.5);

        vertex(x, y, z);
      }
    </script>
  </body>
</html>
