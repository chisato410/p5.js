<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>Cosmic Circles</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <style>
      body {
        background: #111;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
      }
      canvas {
        border: 4px double #ffff00;
        border-radius: 20px;
        width: 500px;
        height: 500px;
      }
      .caption {
        position: absolute;
        left: 16px;
        bottom: 16px;
        color: #fff;
        font-family: Helvetica, Arial;
      }
    </style>
  </head>
  <body>
    <div class="caption">Cosmic Circles</div>
    <script>
      let shapes = [];
      const shapesNum = 5000;
      let sMax;

      function setup() {
        createCanvas(500, 500);
        colorMode(HSB, 360, 100, 100, 1);
        sMax = min(width, height) * 0.3;
        for (let i = 0; i < shapesNum; i++) {
          shapes.push(new Shape(i));
        }
        background(210, 30, 95);
      }

      function draw() {
        background(210, 30, 95, 0.15);
        noStroke();
        for (let i = 0; i < shapes.length; i++) {
          shapes[i].move();
          shapes[i].display();
        }
      }

      class Shape {
        constructor(i) {
          this.i = i * 0.01;
          this.A = 0;
          this.B = 0;
          this.S = i % sMax;
          this.sizeFactor = random(0.1, 0.3);
          this.hueOffset = random(360);
        }
        move() {
          this.S += 1;
          if (this.S > sMax) this.S = 0;
        }
        display() {
          this.A = (cos(this.i * 3) - cos(this.i * 6) + 9) * 0.45;
          this.B = this.i / 2 + (sin(this.i * 3) - sin(this.i * 6)) / 3;
          fill(
            (sin(this.B * 10 + frameCount * 0.05) * 180 + this.hueOffset) % 360,
            80,
            100,
            0.7
          );
          circle(
            this.S * this.A * cos(this.B) + width / 2,
            this.S * this.A * sin(this.B) + height / 2,
            this.S * this.sizeFactor * sin(this.i * 11)
          );
        }
      }
    </script>
  </body>
</html>
